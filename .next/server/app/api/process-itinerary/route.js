"use strict";(()=>{var e={};e.id=175,e.ids=[175],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},7702:e=>{e.exports=require("events")},2048:e=>{e.exports=require("fs")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8216:e=>{e.exports=require("net")},5315:e=>{e.exports=require("path")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},4175:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>y,serverHooks:()=>m,staticGenerationAsyncStorage:()=>q});var t={};o.r(t),o.d(t,{POST:()=>x,dynamic:()=>g,maxDuration:()=>d,runtime:()=>l});var s=o(9303),n=o(8716),i=o(3131),a=o(7070),p=o(647),u=o(5662),c=o(6287);let l="nodejs",d=300,g="force-dynamic";async function x(e){try{let r;console.log(`Process itinerary API called at ${new Date().toISOString()}`),console.log("Environment: production");try{r=await e.json()}catch(e){return console.error("Error parsing request body:",e),a.NextResponse.json({error:"Invalid request body"},{status:400})}let{jobId:o,surveyData:t,prompt:s}=r;if(!o||!t)return console.error("Missing required fields in request body"),a.NextResponse.json({error:"Missing required fields"},{status:400});console.log(`Processing itinerary for job ${o}`),await (0,u.L2)(o,"processing");let n=process.env.OPENAI_API_KEY||"";if(!n||!n.startsWith("sk-"))return console.error("Invalid OpenAI API key configuration"),await (0,u.L2)(o,"failed",{error:"Invalid OpenAI API key configuration"}),a.NextResponse.json({error:"API configuration error"},{status:500});try{console.log(`Calling OpenAI for job ${o}`);let e=s||(0,c.generatePrompt)(t);return await (0,p.E_)(o,t,e,n),console.log(`Successfully generated itinerary for job ${o}`),a.NextResponse.json({success:!0,jobId:o})}catch(e){return console.error(`Error processing itinerary for job ${o}:`,e),await (0,u.L2)(o,"failed",{error:e.message||"Unknown error"}),a.NextResponse.json({error:`Processing error: ${e.message}`},{status:500})}}catch(e){return console.error("Error in process-itinerary handler:",e),a.NextResponse.json({error:`Server error: ${e.message}`},{status:500})}}let y=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/process-itinerary/route",pathname:"/api/process-itinerary",filename:"route",bundlePath:"app/api/process-itinerary/route"},resolvedPagePath:"/Users/ethanhoppe/Desktop/AItravelagent/app/api/process-itinerary/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:f,staticGenerationAsyncStorage:q,serverHooks:m}=y,h="/api/process-itinerary/route";function v(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:q})}}};var r=require("../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[276,972,518,662,287],()=>o(4175));module.exports=t})();